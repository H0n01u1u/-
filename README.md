# 公共点转换参数求取与平差计算工具

该项目是一个基于网页的工具，用于计算公共点转换参数并进行平差计算。用户可以上传Excel文件，分析坐标数据，计算平差参数，并选择是否显示详细的矩阵运算过程。

## 相关知识

#### 原理基础：测站坐标系与测量坐标系的转换

![image-20240925222554428](https://github.com/H0n01u1u/-/blob/main/image/image-20240925222554428.png?raw=true)

![image-20240925222654963](https://github.com/H0n01u1u/-/blob/main/image/image-20240925222654963.png?raw=true)

![image-20240925222714815](https://github.com/H0n01u1u/-/blob/main/image/image-20240925222714815.png?raw=true)

![image-20240925222801841](https://github.com/H0n01u1u/-/blob/main/image/image-20240925222801841.png?raw=true)



## 功能

- **文件上传与解析**：支持上传`.xlsx`文件，解析其中的数据并在网页上展示。
- **坐标转换参数分析**：根据上传的坐标数据计算初始转换参数，包括`c0`、`d0`、`X_P0`、`Y_P0`。
- **平差计算**：通过矩阵运算，对数据进行平差计算。用户可以选择不同的权阵（单位阵或自定义矩阵）。
- **显示计算过程**：用户可以选择是否显示详细的矩阵运算过程，包括`B`矩阵、`L`矩阵、`N_bb`矩阵、`W`矩阵等。
- **计算精度选择**：用户可选择不同的小数位数用于计算结果的精度。

## 使用方法

1. **文件上传**：点击页面中的“选择文件”按钮，上传`.xlsx`格式的Excel文件。
2. **查看文件内容**：文件上传成功后，页面将以表格形式展示文件数据。
3. **选择计算精度**：选择计算结果的精度（小数位数）。
4. **分析数据**：点击“分析数据”按钮，计算初始的坐标转换参数。
5. **选择权阵**：选择平差计算的权阵（单位阵或自定义权阵），如果选择自定义，需要输入自定义的矩阵。
6. **进行平差计算**：点击“平差计算”按钮，计算并展示调整后的参数。
7. **查看详细过程（可选）**：勾选“显示计算过程参数”选项，查看详细的矩阵运算过程。

## 文件格式要求

- 示例文件可在`工测大作业-示例文件.xlsx`文件查看。
- 上传的文件必须为`.xlsx`格式。
- 文件应包含坐标数据，表格中的数据格式如下：
  - **第一行**：列标题。
  - **第一列与第五列**：点号，可以是任意的字符，对数据处理没有任何影响。但是需要注意每一行仅可存在一组且一一对应。
  - **第二列与第三列**：测量坐标系下的坐标（原始坐标），分别对应x、y两个方向的坐标。
  - **第六列与第七列**：测站坐标系下的坐标（转换后坐标），分别对应x、y两个方向的坐标。
  - **第四列**：备注行，可留空。不影响数据处理。

## 开发依赖

- [XLSX.js](https://github.com/SheetJS/sheetjs) - 用于解析Excel文件。
- [numeric.js](http://www.numericjs.com/) - 用于矩阵运算。

## 许可证

此项目基于Apache-2.0许可证开源。
